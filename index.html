<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Open World Sim: Kazakhstan</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background: #222;
            font-family: 'Segoe UI', sans-serif;
            color: white;
            touch-action: none; /* –ß—Ç–æ–±—ã –Ω–µ —Å–∫—Ä–æ–ª–ª–∏—Ç—å –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–µ */
        }

        /* –ò–≥—Ä–æ–≤–æ–π —Ö–æ–ª—Å—Ç */
        canvas {
            display: block;
            background: #2a2a2a;
        }

        /* –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å (–•–£–î) */
        #ui-layer {
            position: absolute;
            top: 10px;
            left: 10px;
            pointer-events: none; /* –ü—Ä–æ–ø—É—Å–∫–∞—Ç—å –∫–ª–∏–∫–∏ —Å–∫–≤–æ–∑—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å */
        }

        .stat-box {
            background: rgba(0, 0, 0, 0.7);
            padding: 10px 15px;
            border-radius: 8px;
            margin-bottom: 5px;
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: bold;
            border: 1px solid #444;
        }

        .bar-container {
            width: 100px;
            height: 10px;
            background: #555;
            border-radius: 5px;
            overflow: hidden;
        }
        .bar-fill { height: 100%; transition: width 0.2s; }
        .bar-hp { background: #e74c3c; } /* –ï–¥–∞ */
        .bar-water { background: #3498db; } /* –í–æ–¥–∞ */

        /* –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è (–ø—Ä–æ–º–æ–∫–æ–¥) */
        #controls-layer {
            position: absolute;
            top: 10px;
            right: 10px;
            display: flex;
            gap: 10px;
        }

        .btn {
            background: linear-gradient(45deg, #f1c40f, #f39c12);
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            color: #000;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 4px 10px rgba(0,0,0,0.5);
            transition: transform 0.1s;
        }
        .btn:active { transform: scale(0.95); }
        .btn-promo { background: linear-gradient(45deg, #9b59b6, #8e44ad); color: white; }

        /* –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ (–ó–¥–∞–Ω–∏—è) */
        .modal {
            display: none;
            position: fixed;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            background: #333;
            padding: 20px;
            border-radius: 15px;
            width: 300px;
            box-shadow: 0 0 30px rgba(0,0,0,0.8);
            border: 2px solid #fff;
            text-align: center;
            z-index: 10;
        }
        .modal h2 { margin-top: 0; color: #f1c40f; }
        .modal-btn {
            display: block;
            width: 100%;
            padding: 12px;
            margin: 10px 0;
            background: #444;
            color: white;
            border: 1px solid #666;
            border-radius: 5px;
            cursor: pointer;
        }
        .modal-btn:hover { background: #555; }
        .close-btn { background: #c0392b; border-color: #e74c3c; }

        /* –î–∂–æ–π—Å—Ç–∏–∫ –¥–ª—è —Ç–µ–ª–µ—Ñ–æ–Ω–∞ */
        #joystick-zone {
            position: absolute;
            bottom: 50px;
            left: 50px;
            width: 120px;
            height: 120px;
            background: rgba(255,255,255,0.1);
            border-radius: 50%;
            display: none; /* –í–∫–ª—é—á–∏—Ç—Å—è, –µ—Å–ª–∏ —Ç–∞—á—Å–∫—Ä–∏–Ω */
        }

        /* –°–æ–æ–±—â–µ–Ω–∏—è */
        #msg {
            position: absolute;
            bottom: 20%;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0,0,0,0.8);
            padding: 10px 20px;
            border-radius: 20px;
            opacity: 0;
            transition: opacity 0.5s;
            pointer-events: none;
        }
    </style>
</head>
<body>

    <canvas id="gameCanvas"></canvas>

    <div id="ui-layer">
        <div class="stat-box">
            üí∞ <span id="moneyVal">2000</span> ‚Ç∏
        </div>
        <div class="stat-box" style="font-size: 0.8rem; color:#aaa;" id="debtBox">
            –ö—Ä–µ–¥–∏—Ç: 0 ‚Ç∏
        </div>
        <div class="stat-box">
            üçî <div class="bar-container"><div class="bar-fill bar-hp" id="hungerBar" style="width: 100%;"></div></div>
        </div>
        <div class="stat-box">
            üíß <div class="bar-container"><div class="bar-fill bar-water" id="thirstBar" style="width: 100%;"></div></div>
        </div>
    </div>

    <div id="controls-layer">
        <button class="btn btn-promo" onclick="enterPromo()">üéÅ –ü–†–û–ú–û–ö–û–î</button>
    </div>

    <div id="msg">–°–æ–æ–±—â–µ–Ω–∏–µ</div>

    <div id="modal-work" class="modal">
        <h2>üèóÔ∏è –°—Ç—Ä–æ–π–∫–∞</h2>
        <p>–ù—É–∂–Ω—ã –¥–µ–Ω—å–≥–∏? –†–∞–±–æ—Ç–∞–π!</p>
        <button class="modal-btn" onclick="doWork()">–¢–∞—Å–∫–∞—Ç—å –∫–∏—Ä–ø–∏—á–∏ (+1000‚Ç∏)</button>
        <button class="modal-btn close-btn" onclick="closeModal()">–£–π—Ç–∏</button>
    </div>

    <div id="modal-shop" class="modal">
        <h2>üõí –ú–∞–≥–∞–∑–∏–Ω</h2>
        <button class="modal-btn" onclick="buyItem('bread', 200, 20, 0)">üçû –•–ª–µ–± (200‚Ç∏)</button>
        <button class="modal-btn" onclick="buyItem('cola', 300, 0, 30)">ü•§ –ö–æ–ª–∞ (300‚Ç∏)</button>
        <button class="modal-btn" onclick="buyItem('doner', 1200, 50, 10)">ü•ô –î–æ–Ω–µ—Ä (1200‚Ç∏)</button>
        <button class="modal-btn close-btn" onclick="closeModal()">–í—ã–π—Ç–∏</button>
    </div>

    <div id="modal-bank" class="modal">
        <h2>üè¶ Kaspi Bank</h2>
        <p>–õ–∏–º–∏—Ç –∫—Ä–µ–¥–∏—Ç–∞: 10 000 ‚Ç∏</p>
        <button class="modal-btn" onclick="takeLoan()">–í–∑—è—Ç—å 5000 ‚Ç∏</button>
        <button class="modal-btn" onclick="repayLoan()">–í–µ—Ä–Ω—É—Ç—å 5000 ‚Ç∏</button>
        <button class="modal-btn close-btn" onclick="closeModal()">–£–π—Ç–∏</button>
    </div>

    <div id="modal-casino" class="modal">
        <h2>üé∞ –ö–∞–∑–∏–Ω–æ</h2>
        <input type="number" id="betInput" placeholder="–°—Ç–∞–≤–∫–∞" style="width:80%; padding:10px; margin-bottom:10px;">
        <div style="display:flex; gap:5px;">
            <button class="modal-btn" style="background:#c0392b" onclick="spinCasino(true)">–ö—Ä–∞—Å–Ω–æ–µ (x2)</button>
            <button class="modal-btn" style="background:#000" onclick="spinCasino(false)">–ß–µ—Ä–Ω–æ–µ (x2)</button>
        </div>
        <button class="modal-btn close-btn" onclick="closeModal()">–£–π—Ç–∏</button>
    </div>

    <script>
        // --- –ù–ê–°–¢–†–û–ô–ö–ò –ò–ì–†–´ ---
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        
        let width, height;
        
        // –î–∞–Ω–Ω—ã–µ –∏–≥—Ä–æ–∫–∞
        let player = { x: 0, y: 0, size: 20, speed: 4, color: '#3498db' };
        let money = 2000;
        let hunger = 100;
        let thirst = 100;
        let debt = 0;
        let isGameActive = true;
        let activeModal = null;

        // –ó–¥–∞–Ω–∏—è –Ω–∞ –∫–∞—Ä—Ç–µ
        const buildings = [
            { id: 'work', x: 100, y: 100, w: 100, h: 80, color: '#e67e22', label: '–†–ê–ë–û–¢–ê' },
            { id: 'shop', x: 400, y: 100, w: 100, h: 80, color: '#2ecc71', label: '–ú–ê–ì–ê–ó–ò–ù' },
            { id: 'bank', x: 100, y: 400, w: 100, h: 80, color: '#e74c3c', label: '–ë–ê–ù–ö' },
            { id: 'casino', x: 400, y: 400, w: 100, h: 80, color: '#9b59b6', label: '–ö–ê–ó–ò–ù–û' }
        ];

        // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–ª–∞–≤–∏–∞—Ç—É—Ä–æ–π
        const keys = {};

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ä–∞–∑–º–µ—Ä–æ–≤
        function resize() {
            width = window.innerWidth;
            height = window.innerHeight;
            canvas.width = width;
            canvas.height = height;
            // –°–ø–∞–≤–Ω –∏–≥—Ä–æ–∫–∞ –≤ —Ü–µ–Ω—Ç—Ä–µ
            if(player.x === 0) {
                player.x = width / 2;
                player.y = height / 2;
            }
        }
        window.addEventListener('resize', resize);
        resize();

        // –°–ª—É—à–∞—Ç–µ–ª–∏ –≤–≤–æ–¥–∞
        window.addEventListener('keydown', e => keys[e.key] = true);
        window.addEventListener('keyup', e => keys[e.key] = false);

        // --- –ò–ì–†–û–í–û–ô –¶–ò–ö–õ ---
        function update() {
            if (!isGameActive || activeModal) return; // –ü–∞—É–∑–∞ –µ—Å–ª–∏ –æ—Ç–∫—Ä—ã—Ç–æ –º–µ–Ω—é

            // –î–≤–∏–∂–µ–Ω–∏–µ
            if (keys['w'] || keys['ArrowUp']) player.y -= player.speed;
            if (keys['s'] || keys['ArrowDown']) player.y += player.speed;
            if (keys['a'] || keys['ArrowLeft']) player.x -= player.speed;
            if (keys['d'] || keys['ArrowRight']) player.x += player.speed;

            // –ì—Ä–∞–Ω–∏—Ü—ã –º–∏—Ä–∞
            if (player.x < 0) player.x = 0;
            if (player.y < 0) player.y = 0;
            if (player.x > width) player.x = width;
            if (player.y > height) player.y = height;

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–ª–ª–∏–∑–∏–π —Å–æ –∑–¥–∞–Ω–∏—è–º–∏
            checkCollisions();
        }

        function draw() {
            // –û—á–∏—Å—Ç–∫–∞
            ctx.fillStyle = '#222'; // –¶–≤–µ—Ç –∞—Å—Ñ–∞–ª—å—Ç–∞
            ctx.fillRect(0, 0, width, height);

            // –°–µ—Ç–∫–∞ (–¥–ª—è –≤–∏–¥–∞ –≥–æ—Ä–æ–¥–∞)
            ctx.strokeStyle = '#333';
            ctx.lineWidth = 2;
            for(let i=0; i<width; i+=50) { ctx.beginPath(); ctx.moveTo(i,0); ctx.lineTo(i,height); ctx.stroke(); }
            for(let i=0; i<height; i+=50) { ctx.beginPath(); ctx.moveTo(0,i); ctx.lineTo(width,i); ctx.stroke(); }

            // –†–∏—Å—É–µ–º –∑–¥–∞–Ω–∏—è
            buildings.forEach(b => {
                ctx.fillStyle = b.color;
                ctx.fillRect(b.x, b.y, b.w, b.h);
                // –¢–µ–Ω—å –∑–¥–∞–Ω–∏—è
                ctx.fillStyle = 'rgba(0,0,0,0.3)';
                ctx.fillRect(b.x + 5, b.y + 5, b.w, b.h);
                // –ü–æ–¥–ø–∏—Å—å
                ctx.fillStyle = 'white';
                ctx.font = 'bold 14px Arial';
                ctx.textAlign = 'center';
                ctx.fillText(b.label, b.x + b.w/2, b.y + b.h/2 + 5);
            });

            // –†–∏—Å—É–µ–º –∏–≥—Ä–æ–∫–∞
            ctx.beginPath();
            ctx.arc(player.x, player.y, player.size, 0, Math.PI*2);
            ctx.fillStyle = player.color;
            ctx.fill();
            ctx.strokeStyle = 'white';
            ctx.lineWidth = 2;
            ctx.stroke();

            // –ü–æ–¥—Å–∫–∞–∑–∫–∞
            ctx.fillStyle = '#aaa';
            ctx.font = '16px Arial';
            ctx.textAlign = 'center';
            ctx.fillText("WASD –∏–ª–∏ –°—Ç—Ä–µ–ª–∫–∏ –¥–ª—è –¥–≤–∏–∂–µ–Ω–∏—è", width/2, height - 30);
        }

        function loop() {
            update();
            draw();
            requestAnimationFrame(loop);
        }
        loop();

        // --- –õ–û–ì–ò–ö–ê –í–ó–ê–ò–ú–û–î–ï–ô–°–¢–í–ò–Ø ---

        function checkCollisions() {
            buildings.forEach(b => {
                // –ü—Ä–æ—Å—Ç–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫–∞ –∏ —Ç–æ—á–∫–∏
                if (player.x > b.x && player.x < b.x + b.w &&
                    player.y > b.y && player.y < b.y + b.h) {
                        openModal('modal-' + b.id);
                        // –û—Ç—Ç–∞–ª–∫–∏–≤–∞–µ–º –∏–≥—Ä–æ–∫–∞ –Ω–µ–º–Ω–æ–≥–æ –Ω–∞–∑–∞–¥, —á—Ç–æ–±—ã –Ω–µ —Å–ø–∞–º–∏—Ç—å –æ—Ç–∫—Ä—ã—Ç–∏–µ
                        if (player.y > b.y + b.h/2) player.y += 20;
                        else player.y -= 20;
                }
            });
        }

        // --- –°–ò–°–¢–ï–ú–ê –ñ–ò–ó–ù–ò ---
        setInterval(() => {
            if (!isGameActive) return;
            hunger -= 1;
            thirst -= 2;
            if (hunger <= 0 || thirst <= 0) gameOver();
            updateUI();
        }, 1000);

        function updateUI() {
            document.getElementById('moneyVal').innerText = money;
            document.getElementById('hungerBar').style.width = hunger + '%';
            document.getElementById('thirstBar').style.width = thirst + '%';
            document.getElementById('debtBox').innerText = debt > 0 ? `–ö—Ä–µ–¥–∏—Ç: ${debt} ‚Ç∏` : "";
        }

        function showMsg(text) {
            const el = document.getElementById('msg');
            el.innerText = text;
            el.style.opacity = 1;
            setTimeout(() => el.style.opacity = 0, 2000);
        }

        // --- –§–£–ù–ö–¶–ò–ò –ó–î–ê–ù–ò–ô ---

        function openModal(id) {
            activeModal = id;
            document.getElementById(id).style.display = 'block';
        }

        function closeModal() {
            if (activeModal) {
                document.getElementById(activeModal).style.display = 'none';
                activeModal = null;
            }
        }

        // –†–∞–±–æ—Ç–∞
        window.doWork = function() {
            if(hunger < 10 || thirst < 10) { showMsg("–°–ª–∏—à–∫–æ–º —Å–ª–∞–± –¥–ª—è —Ä–∞–±–æ—Ç—ã!"); return; }
            money += 1000;
            hunger -= 10;
            thirst -= 10;
            showMsg("+1000 ‚Ç∏ (–£—Å—Ç–∞–ª–æ—Å—Ç—å)");
            updateUI();
        }

        // –ú–∞–≥–∞–∑–∏–Ω
        window.buyItem = function(type, price, food, water) {
            if (money >= price) {
                money -= price;
                hunger = Math.min(100, hunger + food);
                thirst = Math.min(100, thirst + water);
                showMsg("–ö—É–ø–ª–µ–Ω–æ!");
                updateUI();
            } else {
                showMsg("–ù–µ—Ç –¥–µ–Ω–µ–≥!");
            }
        }

        // –ë–∞–Ω–∫
        window.takeLoan = function() {
            if (debt >= 10000) { showMsg("–õ–∏–º–∏—Ç –∏—Å—á–µ—Ä–ø–∞–Ω!"); return; }
            money += 5000;
            debt += 5000;
            showMsg("–ö—Ä–µ–¥–∏—Ç +5000 ‚Ç∏");
            updateUI();
        }
        window.repayLoan = function() {
            if (money >= 5000 && debt > 0) {
                money -= 5000;
                debt -= 5000;
                showMsg("–î–æ–ª–≥ –ø–æ–≥–∞—à–µ–Ω!");
                updateUI();
            }
        }

        // –ö–∞–∑–∏–Ω–æ
        window.spinCasino = function(isRed) {
            let bet = parseInt(document.getElementById('betInput').value);
            if (!bet || bet <= 0 || bet > money) { showMsg("–ù–µ–≤–µ—Ä–Ω–∞—è —Å—Ç–∞–≤–∫–∞!"); return; }
            
            money -= bet;
            let win = Math.random() < 0.5;
            if (win) {
                money += bet * 2;
                showMsg(`–í–´–ò–ì–†–´–®! +${bet*2}`);
            } else {
                showMsg("–ü–†–û–ò–ì–†–´–®...");
            }
            updateUI();
        }

        // --- –ü–†–û–ú–û–ö–û–î–´ ---
        window.enterPromo = function() {
            let code = prompt("–í–≤–µ–¥–∏—Ç–µ –ø—Ä–æ–º–æ–∫–æ–¥:");
            if (!code) return;
            
            // –£–±–∏—Ä–∞–µ–º –ø—Ä–æ–±–µ–ª—ã –∏ –¥–µ–ª–∞–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É
            if (code.trim() === "–ú–∏—Ä–∞—Å") {
                money += 10000;
                alert("‚úÖ –ü—Ä–æ–º–æ–∫–æ–¥ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω!\n–ë–∞–ª–∞–Ω—Å –ø–æ–ø–æ–ª–Ω–µ–Ω –Ω–∞ 10,000 ‚Ç∏");
            } else if (code.trim() === "GreenGamesStudio") {
                money += 100000;
                alert("üëë LEGENDARY CODE!\n–ë–∞–ª–∞–Ω—Å –ø–æ–ø–æ–ª–Ω–µ–Ω –Ω–∞ 100,000 ‚Ç∏");
            } else {
                alert("‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –ø—Ä–æ–º–æ–∫–æ–¥");
            }
            updateUI();
        }

        function gameOver() {
            isGameActive = false;
            alert("GAME OVER\n–¢—ã —É–º–µ—Ä –æ—Ç –≥–æ–ª–æ–¥–∞ –∏–ª–∏ –∂–∞–∂–¥—ã.");
            location.reload();
        }

        // Click to move (–¥–ª—è –º—ã—à–∫–∏)
        canvas.addEventListener('mousedown', (e) => {
            player.x = e.clientX;
            player.y = e.clientY;
        });

    </script>
</body>
</html>
